name: Pull Request Checks

on:
  pull_request:
    branches: [ main ]

jobs:
  pr-checks:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v5
        
      - name: Echo PR information
        run: |
          echo "ğŸ” Running pull request checks..."
          echo "PR Number: ${{ github.event.number }}"
          echo "PR Title: ${{ github.event.pull_request.title }}"
          echo "Author: ${{ github.event.pull_request.user.login }}"
          
      - name: Setup Docker Buildx
        uses: docker/setup-buildx-action@v3
        
      - name: Run basic validation
        run: |
          echo "âœ… Starting validation checks..."
          echo "ğŸ“ Checking for README file..."
          if [ -f README.md ]; then
            echo "âœ… README.md found"
          else
            echo "âŒ README.md not found"
            exit 1
          fi
          
      - name: Build Backend Docker Image
        run: |
          echo "ğŸ³ Building backend Docker image..."
          docker build -f backend/Dockerfile -t delbot-backend:pr-${{ github.event.number }} .
          echo "âœ… Backend Docker image built successfully"
          
      - name: Build Frontend Docker Image
        run: |
          echo "ğŸ³ Building frontend Docker image..."
          docker build -f frontend/Dockerfile -t delbot-frontend:pr-${{ github.event.number }} .
          echo "âœ… Frontend Docker image built successfully"
          
      - name: Docker Images Info
        run: |
          echo "ğŸ“‹ Docker images created:"
          docker images | grep delbot
          echo "ğŸ” Image sizes:"
          docker images --format "table {{.Repository}}\t{{.Tag}}\t{{.Size}}" | grep delbot
          
      - name: Final check
        run: |
          echo "ğŸ‰ All pull request checks completed successfully!"
          echo "âœ… Code builds successfully"
          echo "âœ… Docker images build successfully"
          echo "âœ… Ready for review"
